import{P as e}from"./index-BNaTmjPP.js";function c(t){if(!t||t<=0)return"00:00:00";const a=Math.floor(t/3600),r=Math.floor(t%3600/60),s=t%60;return[a.toString().padStart(2,"0"),r.toString().padStart(2,"0"),s.toString().padStart(2,"0")].join(":")}function i(t){const a=Math.floor(t/3600),r=Math.floor(t%3600/60),s=t%60;return[a.toString().padStart(2,"0"),r.toString().padStart(2,"0"),s.toString().padStart(2,"0")].join(":")}function d(t,a){if(!t||!a)return 0;const r=t/3600;return Math.round(r*a)}function l(t){return!t&&t!==0?"0 ₽":t.toLocaleString("ru-RU")+" ₽"}async function f(){return await e.projects.filter(t=>!t.deletedAt).toArray()}async function u(t){return await e.projects.get(t)}async function w(t){return await e.projects.add({name:t.name,hourlyRate:t.hourlyRate||0,color:t.color||"#6366F1",createdAt:new Date,deletedAt:null})}async function p(t,a){return await e.projects.update(t,a)}async function j(t){await e.transaction("rw",[e.projects,e.tasks],async()=>{await e.projects.update(t,{deletedAt:new Date});const a=await e.tasks.where("projectId").equals(t).toArray(),r=new Date;for(const s of a)s.deletedAt||await e.tasks.update(s.id,{deletedAt:r})})}async function y(){return await e.projects.filter(t=>!!t.deletedAt).toArray()}async function k(t){await e.transaction("rw",[e.projects,e.tasks],async()=>{await e.projects.update(t,{deletedAt:null});const a=await e.tasks.where("projectId").equals(t).toArray();for(const r of a)r.deletedAt&&await e.tasks.update(r.id,{deletedAt:null})})}async function A(t){await e.transaction("rw",[e.projects,e.tasks,e.timeEntries],async()=>{const r=(await e.tasks.where("projectId").equals(t).toArray()).map(s=>s.id);r.length>0&&await e.timeEntries.where("taskId").anyOf(r).delete(),await e.tasks.where("projectId").equals(t).delete(),await e.projects.delete(t)})}async function h(){const t=await e.projects.filter(o=>!!o.deletedAt).toArray(),a=await e.tasks.filter(o=>!!o.deletedAt).toArray(),r=t.map(o=>o.id),s=a.map(o=>o.id);await e.transaction("rw",[e.projects,e.tasks,e.timeEntries],async()=>{s.length>0&&await e.timeEntries.where("taskId").anyOf(s).delete();for(const o of s)await e.tasks.delete(o);for(const o of r)await e.projects.delete(o)})}export{l as a,u as b,d as c,j as d,w as e,c as f,f as g,i as h,y as i,h as j,A as p,k as r,p as u};
